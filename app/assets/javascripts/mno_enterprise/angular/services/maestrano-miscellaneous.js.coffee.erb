angular.module('maestrano.services.miscellaneous', []).factory('Miscellaneous', ['$http','$q', ($http, $q) ->
  service = {}

  # Currencies
  <% currencies = Country.all.map { |country| Country[country[1]].data['currency'] }.select { |e| e != nil }.sort %>
  <% currencies = (["USD","AUD","EUR"] + currencies).uniq %>
  service.currencies = <%= currencies %>
  
  # Default currency
  service.defaultCurrency = "<%= MnoEnterprise.app_currency %>"
  
  # Countries
  service.countries = [
    <% Country.all.sort.each do |country,code| %>
     { label:"<%= country %>", val: "<%= code %>", ext: "<%= Country.new(code).country_code %>" }
    <% end %>
  ]
  
  # Default country
  service.defaultCountry = "<%= MnoEnterprise.app_country %>"
  
  # Phone country code
  service.countryCodes = <%= Country.all.map { |c| [c[1],"(#{c[1]}) +#{Country[c[1]].country_code}"] } %>

  # Impac! API URL
  service.impacUrls = <%= {
    get_widget:  "#{MnoEnterprise.router.impac_root_url}/get_widget"
  }.to_json %>

  # Impac! Colors configuration
  service.impacTenantColors = <%= {
    positive: MnoEnterprise.style.palette.impac.positive, 
    negative: MnoEnterprise.style.palette.impac.negative, 
    array: MnoEnterprise.style.palette.impac.pool
  }.to_json %>
  
  # Maestrano Style Configuration
  service.style = <%= MnoEnterprise.style.to_json %>

  return service

])

# Increment version below to force
# asset reload
# 71